Challenge: Net Support
Category: Malware
Author: Ben Folland

Description:

An unexpected Remote Monitoring and Management (RMM) tool was identified on this laptop. We identified a suspicious PowerShell script written to disk at a similar time. Can you find the link between the two?

NOTE

The password to the ZIP archive is netsupport

netsupport.zip 3.92 MB

Solve:

1. Download and extract the challenge files

┌──(ctf㉿kali)-[~/CTF/huntress2025/malware/netsupport]
└─$ 7z x -pnetsupport netsupport.zip 

7-Zip 25.01 (x64) : Copyright (c) 1999-2025 Igor Pavlov : 2025-08-03
 64-bit locale=en_US.UTF-8 Threads:16 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 3918814 bytes (3827 KiB)

Extracting archive: netsupport.zip
--
Path = netsupport.zip
Type = zip
Physical Size = 3918814

Everything is Ok

Size:       11336703
Compressed: 3918814

2. Open the file in sublime text to discover a powershell file

	a. We can see the file builds a ZIP archive
	b. I defanged the sample to just build out the ZIP archive in my current directory on my Kali VM [stage2.ps1]

3. Running the newly defanged [stage2.ps1] we get our custom ZIP file [stage2.zip]
                                                                                                                                                                                                                          
┌──(ctf㉿kali)-[~/CTF/huntress2025/malware/netsupport]
└─$ pwsh stage2.ps1                                    
                                                                                                                                                                                                                                            
┌──(ctf㉿kali)-[~/CTF/huntress2025/malware/netsupport]
└─$ ls
netsupport.zip  stage2.ps1  stage2.zip

4. Extracting stage2.zip we get a new directory called "Download" full of new files to analyze

┌──(ctf㉿kali)-[~/CTF/huntress2025/malware/netsupport]
└─$ 7z x stage2.zip

7-Zip 25.01 (x64) : Copyright (c) 1999-2025 Igor Pavlov : 2025-08-03
 64-bit locale=en_US.UTF-8 Threads:16 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 3165936 bytes (3092 KiB)

Extracting archive: stage2.zip

WARNINGS:
There are data after the end of archive

--
Path = stage2.zip
Type = zip
WARNINGS:
There are data after the end of archive
Physical Size = 3165934
Tail Size = 2

Everything is Ok

Archives with Warnings: 1

Warnings: 1
Folders: 1
Files: 15
Size:       6828979
Compressed: 3165936
                                                                                                                                                                                                                                            
┌──(ctf㉿kali)-[~/CTF/huntress2025/malware/netsupport]
└─$ ls
download  netsupport.zip  stage2.ps1  stage2.zip
                                                                                                                                                                                                                                            
┌──(ctf㉿kali)-[~/CTF/huntress2025/malware/netsupport]
└─$ cd download  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
┌──(ctf㉿kali)-[~/…/huntress2025/malware/netsupport/download]
└─$ ls -lah                
total 6.6M
drwxrwxr-x 2 ctf ctf 4.0K Oct  7 18:50 .
drwxrwxr-x 3 ctf ctf 4.0K Oct 23 10:17 ..
-rw-rw-r-- 1 ctf ctf  88K Jul 13 14:09 AudioCapture.dll
-rw-rw-r-- 1 ctf ctf 119K Apr 14  2025 client32.exe
-rw-rw-r-- 1 ctf ctf  901 Oct  7 18:53 CLIENT32.ini
-rw-rw-r-- 1 ctf ctf 317K Jul 13 14:09 HTCTL32.DLL
-rw-rw-r-- 1 ctf ctf 1.4M Aug  6 00:59 kfla.exe
-rw-rw-r-- 1 ctf ctf 756K Jul 13 14:09 msvcr100.dll
-rw-rw-r-- 1 ctf ctf  328 Jul 13 14:09 nskbfltr.inf
-rw-rw-r-- 1 ctf ctf 6.0K Jul 13 14:09 NSM.ini
-rw-rw-r-- 1 ctf ctf  253 Jul 13  2012 NSM.LIC
-rw-rw-r-- 1 ctf ctf   46 Jul 13 14:09 nsm_vpro.ini
-rw-rw-r-- 1 ctf ctf 107K Jul 13 14:09 pcicapi.dll
-rw-rw-r-- 1 ctf ctf  15K Jul 13 14:09 PCICHEK.DLL
-rw-rw-r-- 1 ctf ctf 3.4M Jul 13 14:09 PCICL32.DLL
-rw-rw-r-- 1 ctf ctf  59K Jul 13 14:09 remcmdstub.exe
-rw-rw-r-- 1 ctf ctf 379K Jul 13 14:09 TCCTL32.DLL

5. We find a Base64 string inside of "client32.ini"

	a. CLIENT32.ini:Flag=ZmxhZ3tiNmU1NGQwYTBhNWYyMjkyNTg5YzM4NTJmMTkzMDg5MX0NCg==
	b. Carving this out the base64 we can easily capture our flag

	┌──(ctf㉿kali)-[~/…/huntress2025/malware/netsupport/download]
	└─$ grep -r "Zmxh" | cut -d ":" -f2 | cut -d "=" -f2 | base64 -d
	flag{b6e54d0a0a5f2292589c3852f1930891}

Flag: flag{b6e54d0a0a5f2292589c3852f1930891}